/*!
 * ecode-js v0.1.0
 * (c) 2019 Emoji Generator
 * @license MIT
 */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).EcodeJs={})}(this,function(e){"use strict";function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function n(e,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function o(e,r,o){return r&&n(e.prototype,r),o&&n(e,o),e}var t=function(e,r){return e(r={exports:{}},r.exports),r.exports}(function(e){function r(){}function n(){}!function(){function e(e,r){var n;r=r||1/0;for(var o=e.length,t=null,i=[],a=0;a<o;a++){if((n=e.charCodeAt(a))>55295&&n<57344){if(!t){if(n>56319){(r-=3)>-1&&i.push(239,191,189);continue}if(a+1===o){(r-=3)>-1&&i.push(239,191,189);continue}t=n;continue}if(n<56320){(r-=3)>-1&&i.push(239,191,189),t=n;continue}n=t-55296<<10|n-56320|65536,t=null}else t&&((r-=3)>-1&&i.push(239,191,189),t=null);if(n<128){if((r-=1)<0)break;i.push(n)}else if(n<2048){if((r-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((r-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<2097152))throw new Error("Invalid code point");if((r-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function o(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}r.prototype.encode=function(r){return"undefined"==typeof Uint8Array?e(r):new Uint8Array(e(r))},n.prototype.decode=function(e){return function(e,r,n){var t="",i="";n=Math.min(e.length,n||1/0);for(var a=r=r||0;a<n;a++)e[a]<=127?(t+=o(i)+String.fromCharCode(e[a]),i=""):i+="%"+e[a].toString(16);return t+o(i)}(e,0,e.length)}}(),e&&(e.exports.TextDecoderLite=n,e.exports.TextEncoderLite=r)}),i=(t.TextDecoderLite,t.TextEncoderLite,{encode:"undefined"!=typeof window&&"function"===window.btoa?function(e){return window.btoa(String.fromCharCode(Array.prototype.slice.call(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}:function(e){return Buffer.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},decode:"undefined"!=typeof window&&"function"===window.atob?function(e){return Uint8Array.from(window.atob(e),function(e){return e.charCodeAt(0)})}:function(e){return new Uint8Array(Buffer.from(e,"base64"))}}),a=t.TextEncoderLite,f={ja:0,kr:1,"zh-hant":2,"zh-hans":3,en:4},l={left:0,center:1,right:2},c={mdpi:0,hdpi:1,xhdpi:2,xxhdpi:3},u={png:0,webp:1},d=function(){function e(){r(this,e)}return o(e,[{key:"encodeV1",value:function(e){var r=e.text||"",n=(new a).encode(r);if(0===n.length)throw new Error("empty string is not allowed");var o=new Uint8Array(12+n.length),t=e.locale||"ja",d=f[t.toLowerCase()];if("number"!=typeof d)throw new Error("Illegal locale name : "+e.locale);o[0]|=15&d;var s=this._encodeFlagsV1(e.flags);o[1]|=s<<2&252;var p=e.align||"left",h=l[p.toLowerCase()];if("number"!=typeof h)throw new Error("Illegal align name : "+e.align);o[1]|=3&h;var g=e.size||"mdpi",w=c[g.toLowerCase()];if("number"!=typeof w)throw new Error("Illegal size name : "+e.size);o[2]|=w<<4&240;var y=e.format||"png",v=u[y.toLowerCase()];if("number"!=typeof v)throw new Error("Illegal format name : "+e.format);if(o[2]|=15&v,"number"!=typeof e.fontId)throw new Error("Illegal font ID `"+e.fontId+"`");o[3]|=255&e.fontId;var m=this._encodeColorV1(e.foregroundColor,255);o[4]|=m>>>24&255,o[5]|=m>>>16&255,o[6]|=m>>>8&255,o[7]|=255&m;var E=this._encodeColorV1(e.backgroundColor,4294967040);o[8]|=E>>>24&255,o[9]|=E>>>16&255,o[10]|=E>>>8&255,o[11]|=255&E;for(var b=0;b<n.length;++b)o[12+b]=n[b];return i.encode(o)}},{key:"_encodeFlagsV1",value:function(e){var r=0;return e&&(e.sizeFixed&&(r|=1),e.stretch&&(r|=2)),r}},{key:"_encodeColorV1",value:function(e,r){if("number"==typeof e)return e;if("string"==typeof e)return parseInt(e.replace(/^#/,""),16);if(!e)return r;throw new Error("Illegal color format `"+e+"`")}}]),e}(),s=t.TextDecoderLite,p={0:"ja",1:"kr",2:"zh-Hant",3:"zh-Hans",4:"en"},h={0:"left",1:"center",2:"right"},g={0:"mdpi",1:"hdpi",2:"xhdpi",3:"xxhdpi"},w={0:"PNG",1:"WebP"},y={EcodeEncoder:d,EcodeDecoder:function(){function e(){r(this,e),this.textDecoder=new s}return o(e,[{key:"decodeV1",value:function(e){var r=i.decode(e);if(r.length<=12)throw new Error("Illegal byte length "+r.length);var n=1+(r[0]>>>4&15);if(1!=n)throw new Error("Illegal version "+n);var o=15&r[0],t=p[o];if("string"!=typeof t)throw new Error("Illegal locale ID "+o);var a={sizeFixed:!!(4&r[1]),stretch:!!(8&r[1])},f=3&r[1],l=h[f];if("string"!=typeof l)throw new Error("Illegal align ID "+f);var c=r[2]>>>4&15,u=g[c];if("string"!=typeof u)throw new Error("Illegal size ID "+c);var d=15&r[2],s=w[d];if("string"!=typeof s)throw new Error("Illegal format ID "+d);var y=255&r[3],v=((255&r[4])<<24|(255&r[5])<<16|(255&r[6])<<8|255&r[7])>>>0,m=((255&r[8])<<24|(255&r[9])<<16|(255&r[10])<<8|255&r[11])>>>0,E=Array.prototype.slice.call(r,12),b=this.textDecoder.decode(E);if(0===b.length)throw new Error("Empty string is not allowed");return{version:n,locale:t,flags:a,align:l,size:u,format:{id:d,name:s},fontId:y,foregroundColor:{value:v,hex:v.toString(16)},backgroundColor:{value:m,hex:m.toString(16)},text:b}}}]),e}()},v=y.EcodeEncoder,m=y.EcodeDecoder;e.EcodeDecoder=m,e.EcodeEncoder=v,e.default=y,Object.defineProperty(e,"__esModule",{value:!0})});
